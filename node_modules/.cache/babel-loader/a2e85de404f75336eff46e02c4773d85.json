{"ast":null,"code":"import _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _excluded = [\"cropX2\", \"cropY2\", \"crop\", \"watermark\"];\n\nfunction ownKeys(a, b) {\n  var c = Object.keys(a);\n\n  if (Object.getOwnPropertySymbols) {\n    var d = Object.getOwnPropertySymbols(a);\n    b && (d = d.filter(function (b) {\n      return Object.getOwnPropertyDescriptor(a, b).enumerable;\n    })), c.push.apply(c, d);\n  }\n\n  return c;\n}\n\nfunction _objectSpread(a) {\n  for (var b, c = 1; c < arguments.length; c++) b = null == arguments[c] ? {} : arguments[c], c % 2 ? ownKeys(Object(b), !0).forEach(function (c) {\n    _defineProperty(a, c, b[c]);\n  }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(a, Object.getOwnPropertyDescriptors(b)) : ownKeys(Object(b)).forEach(function (c) {\n    Object.defineProperty(a, c, Object.getOwnPropertyDescriptor(b, c));\n  });\n\n  return a;\n}\n\nimport Konva from \"konva\";\nimport { ELLIPSE_CROP, TOOLS_IDS, WATERMARK_ANNOTATION_ID } from \"./constants\";\nimport deepMerge from \"./deepMerge\";\nimport mapNumber from \"./mapNumber\";\nimport { finetuneNameToParamInfo } from \"./operationsToCloudimageUrl\";\n\nvar propertyToOperation = function (a, b) {\n  var c = 2 < arguments.length && arguments[2] !== void 0 ? arguments[2] : {},\n      d = 3 < arguments.length && arguments[3] !== void 0 ? arguments[3] : {};\n\n  switch (a) {\n    case \"wat_text\":\n      return {\n        watermark: {\n          text: b.replaceAll(\"+\", \" \")\n        }\n      };\n\n    case \"wat_font\":\n      return {\n        watermark: {\n          fontFamily: b\n        }\n      };\n\n    case \"wat_color\":\n      return {\n        watermark: {\n          fill: \"#\".concat(b)\n        }\n      };\n\n    case \"wat_fontsize\":\n      return {\n        watermark: {\n          fontSize: parseFloat(b)\n        }\n      };\n\n    case \"wat_opacity\":\n      return {\n        watermark: {\n          opacity: parseFloat(b)\n        }\n      };\n\n    case \"wat_pos\":\n      {\n        var e = b.split(\",\"),\n            f = _slicedToArray(e, 2),\n            g = f[0],\n            h = f[1];\n\n        return {\n          watermark: {\n            x: parseFloat(g) / 100 * c.width,\n            y: parseFloat(h) / 100 * c.height\n          }\n        };\n      }\n\n    case \"wat_url\":\n      return {\n        watermark: {\n          image: decodeURIComponent(b)\n        }\n      };\n\n    case \"wat_scale\":\n      {\n        var i = b.split(\",\"),\n            j = _slicedToArray(i, 2),\n            k = j[0],\n            l = j[1];\n\n        return {\n          watermark: {\n            width: parseFloat(k) / 100 * (c.width || 0),\n            height: parseFloat(l) / 100 * (c.height || 0)\n          }\n        };\n      }\n\n    case \"tl_px\":\n      {\n        var m = b.split(\",\"),\n            n = _slicedToArray(m, 2),\n            o = n[0],\n            p = n[1];\n\n        return {\n          crop: {\n            x: mapNumber(parseFloat(o), 0, d.width, 0, c.width),\n            y: mapNumber(parseFloat(p), 0, d.height, 0, c.height)\n          }\n        };\n      }\n\n    case \"br_px\":\n      {\n        var q = b.split(\",\"),\n            r = _slicedToArray(q, 2),\n            s = r[0],\n            t = r[1];\n\n        return {\n          cropX2: mapNumber(parseFloat(s), 0, d.width, 0, c.width),\n          cropY2: mapNumber(parseFloat(t), 0, d.height, 0, c.height)\n        };\n      }\n\n    case \"round\":\n      return {\n        crop: {\n          ratio: ELLIPSE_CROP\n        }\n      };\n\n    case \"w\":\n      return {\n        resize: {\n          width: parseFloat(b)\n        }\n      };\n\n    case \"h\":\n      return {\n        resize: {\n          height: parseFloat(b)\n        }\n      };\n\n    case \"r\":\n      return {\n        adjustments: {\n          rotation: -parseInt(b, 10)\n        }\n      };\n\n    case \"flip\":\n    case \"mirror\":\n      return {\n        adjustments: {\n          isFlippedX: b.includes(\"x\") || b.includes(\"h\"),\n          isFlippedY: b.includes(\"y\") || b.includes(\"v\")\n        }\n      };\n\n    default:\n      {\n        var x;\n        if (Object.keys(finetuneNameToParamInfo).forEach(function (b) {\n          finetuneNameToParamInfo[b].cloudimage.name === a.toLowerCase() && (x = b);\n        }), !x) return null;\n        var u = finetuneNameToParamInfo[x],\n            v = u.cloudimage,\n            w = u.internal;\n        return {\n          finetunes: [Konva.Filters[x]],\n          finetunesProps: _defineProperty({}, w.propName, mapNumber(parseFloat(b), v.min, v.max, w.min, w.max))\n        };\n      }\n  }\n},\n    cloudimageQueryToDesignState = function (a, b, c) {\n  if (!a) return null;\n  var d = a.split(\"&\"),\n      e = {};\n  d.forEach(function (a) {\n    var d = a.split(\"=\"),\n        f = _slicedToArray(d, 2),\n        g = f[0],\n        h = f[1],\n        i = propertyToOperation(g, h, b, c);\n\n    i && (e = deepMerge(e, i, !0));\n  });\n\n  var f = e,\n      g = f.cropX2,\n      h = f.cropY2,\n      i = f.crop,\n      j = f.watermark,\n      k = _objectWithoutProperties(f, _excluded),\n      l = _objectSpread(_objectSpread(_objectSpread({}, k), g && h && i ? {\n    adjustments: _objectSpread(_objectSpread({}, k.adjustments), {}, {\n      crop: _objectSpread(_objectSpread({}, i), {}, {\n        width: (g || 0) - i.x,\n        height: (h || 0) - i.y\n      })\n    })\n  } : {}), {}, {\n    annotations: _objectSpread({}, j ? _defineProperty({}, WATERMARK_ANNOTATION_ID, _objectSpread(_objectSpread({}, j), {}, {\n      x: ((null === i || void 0 === i ? void 0 : i.x) || 0) + (j.x || 0),\n      y: ((null === i || void 0 === i ? void 0 : i.y) || 0) + (j.y || 0),\n      id: WATERMARK_ANNOTATION_ID,\n      name: j.text ? TOOLS_IDS.TEXT : TOOLS_IDS.IMAGE\n    }, j.text ? {\n      width: j.text.length * j.fontSize,\n      height: j.fontSize\n    } : {})) : {})\n  });\n\n  return l;\n};\n\nexport default cloudimageQueryToDesignState;","map":{"version":3,"sources":["/Users/devusama/Work/FYP_FrontEnd/node_modules/react-filerobot-image-editor/lib/utils/cloudimageQueryToDesignState.js"],"names":["_objectWithoutProperties","_defineProperty","_slicedToArray","_excluded","ownKeys","a","b","c","Object","keys","getOwnPropertySymbols","d","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","getOwnPropertyDescriptors","defineProperties","defineProperty","Konva","ELLIPSE_CROP","TOOLS_IDS","WATERMARK_ANNOTATION_ID","deepMerge","mapNumber","finetuneNameToParamInfo","propertyToOperation","watermark","text","replaceAll","fontFamily","fill","concat","fontSize","parseFloat","opacity","e","split","f","g","h","x","width","y","height","image","decodeURIComponent","i","j","k","l","m","n","o","p","crop","q","r","s","t","cropX2","cropY2","ratio","resize","adjustments","rotation","parseInt","isFlippedX","includes","isFlippedY","cloudimage","name","toLowerCase","u","v","w","internal","finetunes","Filters","finetunesProps","propName","min","max","cloudimageQueryToDesignState","annotations","id","TEXT","IMAGE"],"mappings":"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","sourcesContent":["import _objectWithoutProperties from\"@babel/runtime/helpers/objectWithoutProperties\";import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";var _excluded=[\"cropX2\",\"cropY2\",\"crop\",\"watermark\"];function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(Object(b),!0).forEach(function(c){_defineProperty(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(Object(b)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}import Konva from\"konva\";import{ELLIPSE_CROP,TOOLS_IDS,WATERMARK_ANNOTATION_ID}from\"./constants\";import deepMerge from\"./deepMerge\";import mapNumber from\"./mapNumber\";import{finetuneNameToParamInfo}from\"./operationsToCloudimageUrl\";var propertyToOperation=function(a,b){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{},d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:{};switch(a){case\"wat_text\":return{watermark:{text:b.replaceAll(\"+\",\" \")}};case\"wat_font\":return{watermark:{fontFamily:b}};case\"wat_color\":return{watermark:{fill:\"#\".concat(b)}};case\"wat_fontsize\":return{watermark:{fontSize:parseFloat(b)}};case\"wat_opacity\":return{watermark:{opacity:parseFloat(b)}};case\"wat_pos\":{var e=b.split(\",\"),f=_slicedToArray(e,2),g=f[0],h=f[1];return{watermark:{x:parseFloat(g)/100*c.width,y:parseFloat(h)/100*c.height}}}case\"wat_url\":return{watermark:{image:decodeURIComponent(b)}};case\"wat_scale\":{var i=b.split(\",\"),j=_slicedToArray(i,2),k=j[0],l=j[1];return{watermark:{width:parseFloat(k)/100*(c.width||0),height:parseFloat(l)/100*(c.height||0)}}}case\"tl_px\":{var m=b.split(\",\"),n=_slicedToArray(m,2),o=n[0],p=n[1];return{crop:{x:mapNumber(parseFloat(o),0,d.width,0,c.width),y:mapNumber(parseFloat(p),0,d.height,0,c.height)}}}case\"br_px\":{var q=b.split(\",\"),r=_slicedToArray(q,2),s=r[0],t=r[1];return{cropX2:mapNumber(parseFloat(s),0,d.width,0,c.width),cropY2:mapNumber(parseFloat(t),0,d.height,0,c.height)}}case\"round\":return{crop:{ratio:ELLIPSE_CROP}};case\"w\":return{resize:{width:parseFloat(b)}};case\"h\":return{resize:{height:parseFloat(b)}};case\"r\":return{adjustments:{rotation:-parseInt(b,10)}};case\"flip\":case\"mirror\":return{adjustments:{isFlippedX:b.includes(\"x\")||b.includes(\"h\"),isFlippedY:b.includes(\"y\")||b.includes(\"v\")}};default:{var x;if(Object.keys(finetuneNameToParamInfo).forEach(function(b){finetuneNameToParamInfo[b].cloudimage.name===a.toLowerCase()&&(x=b)}),!x)return null;var u=finetuneNameToParamInfo[x],v=u.cloudimage,w=u.internal;return{finetunes:[Konva.Filters[x]],finetunesProps:_defineProperty({},w.propName,mapNumber(parseFloat(b),v.min,v.max,w.min,w.max))}}}},cloudimageQueryToDesignState=function(a,b,c){if(!a)return null;var d=a.split(\"&\"),e={};d.forEach(function(a){var d=a.split(\"=\"),f=_slicedToArray(d,2),g=f[0],h=f[1],i=propertyToOperation(g,h,b,c);i&&(e=deepMerge(e,i,!0))});var f=e,g=f.cropX2,h=f.cropY2,i=f.crop,j=f.watermark,k=_objectWithoutProperties(f,_excluded),l=_objectSpread(_objectSpread(_objectSpread({},k),g&&h&&i?{adjustments:_objectSpread(_objectSpread({},k.adjustments),{},{crop:_objectSpread(_objectSpread({},i),{},{width:(g||0)-i.x,height:(h||0)-i.y})})}:{}),{},{annotations:_objectSpread({},j?_defineProperty({},WATERMARK_ANNOTATION_ID,_objectSpread(_objectSpread({},j),{},{x:((null===i||void 0===i?void 0:i.x)||0)+(j.x||0),y:((null===i||void 0===i?void 0:i.y)||0)+(j.y||0),id:WATERMARK_ANNOTATION_ID,name:j.text?TOOLS_IDS.TEXT:TOOLS_IDS.IMAGE},j.text?{width:j.text.length*j.fontSize,height:j.fontSize}:{})):{})});return l};export default cloudimageQueryToDesignState;"]},"metadata":{},"sourceType":"module"}