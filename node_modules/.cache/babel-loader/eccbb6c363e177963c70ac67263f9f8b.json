{"ast":null,"code":"import _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nvar _excluded = [\"fonts\", \"onFontChange\"],\n    _excluded2 = [\"x\", \"y\", \"width\", \"height\", \"radius\", \"radiusX\", \"radiusY\", \"points\", \"image\", \"text\", \"scaleX\", \"scaleY\", \"rotation\"],\n    _excluded3 = [\"shouldSave\", \"neverSave\"];\n\nfunction ownKeys(a, b) {\n  var c = Object.keys(a);\n\n  if (Object.getOwnPropertySymbols) {\n    var d = Object.getOwnPropertySymbols(a);\n    b && (d = d.filter(function (b) {\n      return Object.getOwnPropertyDescriptor(a, b).enumerable;\n    })), c.push.apply(c, d);\n  }\n\n  return c;\n}\n\nfunction _objectSpread(a) {\n  for (var b, c = 1; c < arguments.length; c++) b = null == arguments[c] ? {} : arguments[c], c % 2 ? ownKeys(Object(b), !0).forEach(function (c) {\n    _defineProperty(a, c, b[c]);\n  }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(a, Object.getOwnPropertyDescriptors(b)) : ownKeys(Object(b)).forEach(function (c) {\n    Object.defineProperty(a, c, Object.getOwnPropertyDescriptor(b, c));\n  });\n\n  return a;\n}\n\nimport { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport { SELECT_ANNOTATION, SET_ANNOTATION } from \"../../actions\";\nimport randomId from \"../../utils/randomId\";\nimport debounce from \"../../utils/debounce\";\nimport { TOOLS_IDS } from \"../../utils/constants\";\nimport { useStore } from \"./..\";\nimport previewThenCallAnnotationAdding from \"./previewThenCallAnnotationAdding\";\nimport useDebouncedCallback from \"../useDebouncedCallback\";\n\nvar useAnnotation = function () {\n  var a,\n      b = 0 < arguments.length && void 0 !== arguments[0] ? arguments[0] : {},\n      c = !(1 < arguments.length && void 0 !== arguments[1]) || arguments[1],\n      d = useStore(),\n      e = d.dispatch,\n      f = d.previewGroup,\n      g = d.annotations,\n      h = d.selectionsIds,\n      i = void 0 === h ? [] : h,\n      j = d.config,\n      k = _objectSpread(_objectSpread({}, j.annotationsCommon), j[(null === (a = g[i[0]]) || void 0 === a ? void 0 : a.name) || b.name]),\n      l = useState(function () {\n    return _objectSpread(_objectSpread(_objectSpread({}, k), b), g[i[0]]);\n  }),\n      m = _slicedToArray(l, 2),\n      n = m[0],\n      o = m[1],\n      p = useRef(),\n      q = null === f || void 0 === f ? void 0 : f.getStage(),\n      r = useCallback(function (a) {\n    var c = a.fonts,\n        d = a.onFontChange,\n        f = _objectWithoutProperties(a, _excluded);\n\n    e({\n      type: SET_ANNOTATION,\n      payload: f\n    }), f.id && b.name !== TOOLS_IDS.PEN && debounce(function () {\n      e({\n        type: SELECT_ANNOTATION,\n        payload: {\n          annotationId: f.id\n        }\n      });\n    }, 30)();\n  }, []),\n      s = useDebouncedCallback(function (a) {\n    o(function (b) {\n      return _objectSpread(_objectSpread({}, b), {}, {\n        shouldSave: !1,\n        neverSave: !1\n      }, \"function\" == typeof a ? a(b) : a);\n    });\n  }, 15),\n      t = useCallback(function (a, c) {\n    if (a.name === c) {\n      var d = a.x,\n          e = a.y,\n          f = a.width,\n          g = a.height,\n          h = a.radius,\n          i = a.radiusX,\n          j = a.radiusY,\n          l = a.points,\n          m = a.image,\n          n = a.text,\n          o = a.scaleX,\n          p = a.scaleY,\n          q = a.rotation,\n          r = _objectWithoutProperties(a, _excluded2);\n\n      return _objectSpread(_objectSpread(_objectSpread({}, k), b), r);\n    }\n\n    return _objectSpread(_objectSpread({}, k), b);\n  }, []),\n      u = useCallback(function (a) {\n    o(function (c) {\n      var d = t(c, a.name || b.name);\n      return _objectSpread(_objectSpread(_objectSpread({}, d), a), {}, {\n        id: a.id || randomId(a.name || c.name),\n        shouldSave: !0,\n        neverSave: !1\n      });\n    });\n  }, []);\n\n  return useEffect(function () {\n    var a = n.shouldSave,\n        b = n.neverSave,\n        c = _objectWithoutProperties(n, _excluded3),\n        d = 1 === i.length && g[i[0]];\n\n    !b && (a || d) && r(_objectSpread(_objectSpread({}, c), {}, {\n      id: a ? c.id : d.id\n    }));\n  }, [n]), useEffect(function () {\n    setTimeout(function () {\n      1 === i.length ? (p.current = n, o(_objectSpread(_objectSpread({}, g[i[0]]), {}, {\n        neverSave: !0\n      }))) : p.current && (o(_objectSpread(_objectSpread({}, p.current), {}, {\n        neverSave: !0\n      })), p.current = null);\n    });\n  }, [i, g]), useEffect(function () {\n    var a = null;\n\n    if (q && c) {\n      var d = t(n, b.name);\n      a = previewThenCallAnnotationAdding(q, _objectSpread(_objectSpread({}, d), {}, {\n        name: b.name\n      }), f, u);\n    }\n\n    return function () {\n      a && a();\n    };\n  }, [q, n, f]), useMemo(function () {\n    return [n, s, u];\n  }, [n, s, u]);\n};\n\nexport default useAnnotation;","map":{"version":3,"sources":["/Users/devusama/Work/FYP_FrontEnd/node_modules/react-filerobot-image-editor/lib/hooks/useAnnotation/index.js"],"names":["_objectWithoutProperties","_slicedToArray","_defineProperty","_excluded","_excluded2","_excluded3","ownKeys","a","b","c","Object","keys","getOwnPropertySymbols","d","filter","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","arguments","length","forEach","getOwnPropertyDescriptors","defineProperties","defineProperty","useCallback","useEffect","useMemo","useRef","useState","SELECT_ANNOTATION","SET_ANNOTATION","randomId","debounce","TOOLS_IDS","useStore","previewThenCallAnnotationAdding","useDebouncedCallback","useAnnotation","e","dispatch","f","previewGroup","g","annotations","h","selectionsIds","i","j","config","k","annotationsCommon","name","l","m","n","o","p","q","getStage","r","fonts","onFontChange","type","payload","id","PEN","annotationId","s","shouldSave","neverSave","t","x","y","width","height","radius","radiusX","radiusY","points","image","text","scaleX","scaleY","rotation","u","setTimeout","current"],"mappings":"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","sourcesContent":["import _objectWithoutProperties from\"@babel/runtime/helpers/objectWithoutProperties\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import _defineProperty from\"@babel/runtime/helpers/defineProperty\";var _excluded=[\"fonts\",\"onFontChange\"],_excluded2=[\"x\",\"y\",\"width\",\"height\",\"radius\",\"radiusX\",\"radiusY\",\"points\",\"image\",\"text\",\"scaleX\",\"scaleY\",\"rotation\"],_excluded3=[\"shouldSave\",\"neverSave\"];function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(Object(b),!0).forEach(function(c){_defineProperty(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(Object(b)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}import{useCallback,useEffect,useMemo,useRef,useState}from\"react\";import{SELECT_ANNOTATION,SET_ANNOTATION}from\"../../actions\";import randomId from\"../../utils/randomId\";import debounce from\"../../utils/debounce\";import{TOOLS_IDS}from\"../../utils/constants\";import{useStore}from\"./..\";import previewThenCallAnnotationAdding from\"./previewThenCallAnnotationAdding\";import useDebouncedCallback from\"../useDebouncedCallback\";var useAnnotation=function(){var a,b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},c=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],d=useStore(),e=d.dispatch,f=d.previewGroup,g=d.annotations,h=d.selectionsIds,i=void 0===h?[]:h,j=d.config,k=_objectSpread(_objectSpread({},j.annotationsCommon),j[(null===(a=g[i[0]])||void 0===a?void 0:a.name)||b.name]),l=useState(function(){return _objectSpread(_objectSpread(_objectSpread({},k),b),g[i[0]])}),m=_slicedToArray(l,2),n=m[0],o=m[1],p=useRef(),q=null===f||void 0===f?void 0:f.getStage(),r=useCallback(function(a){var c=a.fonts,d=a.onFontChange,f=_objectWithoutProperties(a,_excluded);e({type:SET_ANNOTATION,payload:f}),f.id&&b.name!==TOOLS_IDS.PEN&&debounce(function(){e({type:SELECT_ANNOTATION,payload:{annotationId:f.id}})},30)()},[]),s=useDebouncedCallback(function(a){o(function(b){return _objectSpread(_objectSpread({},b),{},{shouldSave:!1,neverSave:!1},\"function\"==typeof a?a(b):a)})},15),t=useCallback(function(a,c){if(a.name===c){var d=a.x,e=a.y,f=a.width,g=a.height,h=a.radius,i=a.radiusX,j=a.radiusY,l=a.points,m=a.image,n=a.text,o=a.scaleX,p=a.scaleY,q=a.rotation,r=_objectWithoutProperties(a,_excluded2);return _objectSpread(_objectSpread(_objectSpread({},k),b),r)}return _objectSpread(_objectSpread({},k),b)},[]),u=useCallback(function(a){o(function(c){var d=t(c,a.name||b.name);return _objectSpread(_objectSpread(_objectSpread({},d),a),{},{id:a.id||randomId(a.name||c.name),shouldSave:!0,neverSave:!1})})},[]);return useEffect(function(){var a=n.shouldSave,b=n.neverSave,c=_objectWithoutProperties(n,_excluded3),d=1===i.length&&g[i[0]];!b&&(a||d)&&r(_objectSpread(_objectSpread({},c),{},{id:a?c.id:d.id}))},[n]),useEffect(function(){setTimeout(function(){1===i.length?(p.current=n,o(_objectSpread(_objectSpread({},g[i[0]]),{},{neverSave:!0}))):p.current&&(o(_objectSpread(_objectSpread({},p.current),{},{neverSave:!0})),p.current=null)})},[i,g]),useEffect(function(){var a=null;if(q&&c){var d=t(n,b.name);a=previewThenCallAnnotationAdding(q,_objectSpread(_objectSpread({},d),{},{name:b.name}),f,u)}return function(){a&&a()}},[q,n,f]),useMemo(function(){return[n,s,u]},[n,s,u])};export default useAnnotation;"]},"metadata":{},"sourceType":"module"}